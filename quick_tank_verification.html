<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ÙØ­Øµ Ø³Ø±ÙŠØ¹ Ù„Ù„Ø®Ø²Ø§Ù†Ø§Øª</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
    .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
    .success { color: #28a745; }
    .error { color: #dc3545; }
    .info { color: #17a2b8; }
    .result { margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 5px; }
    button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ” ÙØ­Øµ Ø³Ø±ÙŠØ¹ Ù„Ø®Ø²Ø§Ù†Ø§Øª PBCR</h1>
    <button onclick="quickCheck()">Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø³Ø±ÙŠØ¹</button>
    <div id="results"></div>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getFirestore, doc, getDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyD7lJcoY33FEC9d6eWy67QIO9SV4lS24pg",
      authDomain: "tank-tools-knpc-c2d95.firebaseapp.com",
      projectId: "tank-tools-knpc-c2d95",
      storageBucket: "tank-tools-knpc-c2d95.firebasestorage.app",
      messagingSenderId: "510062594324",
      appId: "1:510062594324:web:b892fd02007a5ca2f0da01"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Ø¹ÙŠÙ†Ø© Ù…Ù† Ø§Ù„Ø®Ø²Ø§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø© Ù„Ù„ÙØ­Øµ
    const testTanks = [
      { id: '221', expected: { hi: 13.5, lo: 2.5, bpm: 5978 } },
      { id: '225', expected: { hi: 15.240, lo: 3.353, bpm: 12879 } },
      { id: '255', expected: { hi: 14.960, lo: 2.000, bpm: 12287 } },
      { id: '510', expected: { hi: 10.363, lo: 2.000, bpm: 529 } },
      { id: '633', expected: { hi: 6.000, lo: 2.000, bpm: 412 } },
      { id: '756', expected: { hi: 15.100, lo: 2.000, bmp: 12962 } }
    ];

    window.quickCheck = async function() {
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '<div class="info">ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</div>';

      let html = '';
      let successCount = 0;

      try {
        for (const tank of testTanks) {
          const tankRef = doc(db, 'tankData', 'pbcr', 'tanks', tank.id);
          const tankDoc = await getDoc(tankRef);
          
          if (tankDoc.exists()) {
            const data = tankDoc.data();
            const isCorrect = 
              Math.abs((data.max || 0) - tank.expected.hi) < 0.01 &&
              Math.abs((data.min || 0) - tank.expected.lo) < 0.01 &&
              (data.comment || 0) === tank.expected.bpm;
            
            if (isCorrect) {
              successCount++;
              html += `<div class="result success">âœ… TK-${tank.id}: ØµØ­ÙŠØ­ - Hi:${data.max}m Lo:${data.min}m BPM:${data.comment}</div>`;
            } else {
              html += `<div class="result error">âŒ TK-${tank.id}: Ø®Ø·Ø£ - Hi:${data.max || 'N/A'}m Lo:${data.min || 'N/A'}m BPM:${data.comment || 'N/A'}</div>`;
              html += `<div style="margin-left: 20px; font-size: 12px; color: #666;">Ù…ØªÙˆÙ‚Ø¹: Hi:${tank.expected.hi}m Lo:${tank.expected.lo}m BPM:${tank.expected.bpm}</div>`;
            }
          } else {
            html += `<div class="result error">âŒ TK-${tank.id}: ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</div>`;
          }
        }

        const successRate = (successCount / testTanks.length * 100).toFixed(1);
        html = `
          <div class="result info">
            ğŸ“Š <strong>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø³Ø±ÙŠØ¹:</strong><br>
            â€¢ ØªÙ… ÙØ­Øµ: ${testTanks.length} Ø®Ø²Ø§Ù†<br>
            â€¢ ØµØ­ÙŠØ­: ${successCount} Ø®Ø²Ø§Ù†<br>
            â€¢ Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: ${successRate}%<br>
            â€¢ Ø§Ù„Ø­Ø§Ù„Ø©: ${successRate >= 80 ? 'âœ… Ù…Ù…ØªØ§Ø²' : successRate >= 50 ? 'âš ï¸ Ù…Ù‚Ø¨ÙˆÙ„' : 'âŒ ÙŠØ­ØªØ§Ø¬ Ø¹Ù…Ù„'}
          </div>
        ` + html;

        resultsDiv.innerHTML = html;

      } catch (error) {
        resultsDiv.innerHTML = `<div class="result error">âŒ Ø®Ø·Ø£: ${error.message}</div>`;
      }
    };

    console.log('âœ… ÙØ­Øµ Ø§Ù„Ø®Ø²Ø§Ù†Ø§Øª Ø¬Ø§Ù‡Ø²');
  </script>
</body>
</html>