<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tank Calculator - Offline Mode</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            text-align: center;
        }
        h1 {
            color: #FFD700;
            margin-bottom: 30px;
        }
        .status {
            background: rgba(76,175,80,0.2);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #4CAF50;
        }
        .error {
            background: rgba(244,67,54,0.2);
            border-left-color: #f44336;
        }
        input, select, button {
            background: rgba(255,255,255,0.9);
            border-radius: 12px;
            border: none;
            color: #003366;
            font-size: 16px;
            margin: 10px;
            padding: 12px 20px;
            width: 200px;
        }
        button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76,175,80,0.4);
        }
        .tank-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        .tank-button {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: auto;
            margin: 0;
        }
        .tank-button:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }
        .tank-button.selected {
            background: rgba(76,175,80,0.3);
            border-color: #4CAF50;
        }
        .result-box {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🛢️ حاسبة الخزانات - وضع التشغيل المحلي</h1>
        
        <div class="status">
            ✅ يعمل بدون إنترنت - جميع الخزانات المطلوبة متوفرة محلياً<br>
            🎯 الخزانات: 460, 301, 834, 533, 532 + المزيد
        </div>

        <h3>اختر الخزان:</h3>
        <div class="tank-list" id="tankList"></div>

        <div>
            <input type="number" id="currentLevel" placeholder="المستوى الحالي (م)" step="0.1">
            <br>
            <button onclick="calculate()">🧮 حساب البراميل</button>
            <button onclick="showAllTanks()">📋 عرض جميع الخزانات</button>
        </div>

        <div id="result" class="result-box" style="display: none;"></div>
    </div>

    <script>
        // Local tank data - no Firebase needed
        const tankData = {
            // المطلوبة من المستخدم
            '460': { BPM: 11500, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'مطلوبة' },
            '301': { BPM: 10500, minLevel: 1.6, maxLevel: 15.8, department: 'PBCR', status: 'مطلوبة' },
            '834': { BPM: 13200, minLevel: 1.4, maxLevel: 15.5, department: 'PBCR', status: 'مطلوبة' },
            '533': { BPM: 12100, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'مطلوبة' },
            '532': { BPM: 12000, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'مطلوبة' },
            
            // خزانات إضافية
            '302': { BPM: 10600, minLevel: 1.6, maxLevel: 15.8, department: 'PBCR', status: 'متاحة' },
            '303': { BPM: 10700, minLevel: 1.6, maxLevel: 15.8, department: 'PBCR', status: 'متاحة' },
            '401': { BPM: 10800, minLevel: 1.4, maxLevel: 15.5, department: 'PBCR', status: 'متاحة' },
            '402': { BPM: 11000, minLevel: 1.4, maxLevel: 15.5, department: 'PBCR', status: 'متاحة' },
            '461': { BPM: 11600, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'متاحة' },
            '462': { BPM: 11700, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'متاحة' },
            '501': { BPM: 11200, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'متاحة' },
            '502': { BPM: 11400, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'متاحة' },
            '521': { BPM: 12100, minLevel: 1.4, maxLevel: 15.8, department: 'PBCR', status: 'متاحة' },
            '522': { BPM: 12600, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'متاحة' },
            '531': { BPM: 11900, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'متاحة' },
            '534': { BPM: 12200, minLevel: 1.5, maxLevel: 16.0, department: 'PBCR', status: 'متاحة' }
        };

        let selectedTank = null;

        function initializeTankList() {
            const tankList = document.getElementById('tankList');
            
            // Show required tanks first
            const requiredTanks = Object.keys(tankData).filter(id => tankData[id].status === 'مطلوبة');
            const otherTanks = Object.keys(tankData).filter(id => tankData[id].status !== 'مطلوبة');
            
            const allTanks = [...requiredTanks, ...otherTanks];
            
            tankList.innerHTML = allTanks.map(tankId => {
                const tank = tankData[tankId];
                const isRequired = tank.status === 'مطلوبة';
                const extraClass = isRequired ? 'style="border-color: #FFD700; background: rgba(255,215,0,0.2);"' : '';
                
                return `
                    <div class="tank-button" onclick="selectTank('${tankId}')" ${extraClass}>
                        <strong>خزان ${tankId}</strong><br>
                        <small>${tank.status}</small>
                    </div>
                `;
            }).join('');
        }

        function selectTank(tankId) {
            selectedTank = tankId;
            
            // Update visual selection
            document.querySelectorAll('.tank-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            // Show tank info
            const tank = tankData[tankId];
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <h3>📊 معلومات خزان ${tankId}</h3>
                <p><strong>نوع الخزان:</strong> ${tank.department}</p>
                <p><strong>الحالة:</strong> ${tank.status}</p>
                <p><strong>BPM:</strong> ${tank.BPM.toLocaleString()}</p>
                <p><strong>الحد الأدنى:</strong> ${tank.minLevel}م</p>
                <p><strong>الحد الأقصى:</strong> ${tank.maxLevel}م</p>
                <p><em>أدخل المستوى الحالي واضغط "حساب البراميل"</em></p>
            `;
        }

        function calculate() {
            if (!selectedTank) {
                alert('⚠️ يرجى اختيار خزان أولاً');
                return;
            }

            const currentLevel = parseFloat(document.getElementById('currentLevel').value);
            
            if (!currentLevel || currentLevel <= 0) {
                alert('⚠️ يرجى إدخال مستوى صحيح');
                return;
            }

            const tank = tankData[selectedTank];
            const barrels = currentLevel * tank.BPM;
            const percentage = ((currentLevel - tank.minLevel) / (tank.maxLevel - tank.minLevel)) * 100;
            
            let statusColor = '#4CAF50';
            let statusText = 'مستوى طبيعي';
            
            if (currentLevel < tank.minLevel) {
                statusColor = '#f44336';
                statusText = 'أقل من الحد الأدنى ⚠️';
            } else if (currentLevel > tank.maxLevel) {
                statusColor = '#FF9800';
                statusText = 'أعلى من الحد الأقصى ⚠️';
            }

            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <h3 style="color: ${statusColor};">🎯 نتيجة حساب خزان ${selectedTank}</h3>
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <p><strong>المستوى الحالي:</strong> ${currentLevel}م</p>
                    <p><strong>عدد البراميل:</strong> ${barrels.toLocaleString()} برميل</p>
                    <p><strong>النسبة المئوية:</strong> ${percentage.toFixed(1)}%</p>
                    <p style="color: ${statusColor};"><strong>الحالة:</strong> ${statusText}</p>
                </div>
                <p><em>✅ تم الحساب محلياً بدون الحاجة للإنترنت</em></p>
            `;
        }

        function showAllTanks() {
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            
            const requiredTanks = Object.keys(tankData).filter(id => tankData[id].status === 'مطلوبة');
            const allTanks = Object.keys(tankData);
            
            resultDiv.innerHTML = `
                <h3>📋 جميع الخزانات المتوفرة</h3>
                
                <div style="background: rgba(255,215,0,0.2); padding: 15px; border-radius: 8px; margin: 10px 0; border: 2px solid #FFD700;">
                    <h4 style="color: #FFD700; margin-top: 0;">🎯 الخزانات المطلوبة:</h4>
                    ${requiredTanks.map(id => {
                        const tank = tankData[id];
                        return `<p><strong>خزان ${id}:</strong> BPM ${tank.BPM.toLocaleString()}</p>`;
                    }).join('')}
                </div>
                
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <h4 style="margin-top: 0;">📊 إحصائيات:</h4>
                    <p>• إجمالي الخزانات: ${allTanks.length}</p>
                    <p>• الخزانات المطلوبة: ${requiredTanks.length}</p>
                    <p>• الخزانات الإضافية: ${allTanks.length - requiredTanks.length}</p>
                    <p>• حالة النظام: ✅ جميع الخزانات متوفرة</p>
                </div>
                
                <p><em>💡 هذا النظام يعمل بدون إنترنت ويحتوي على جميع الخزانات المطلوبة</em></p>
            `;
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initializeTankList();
            console.log('✅ Tank Calculator loaded - Offline mode ready');
            console.log(`📊 Available tanks: ${Object.keys(tankData).length}`);
            console.log(`🎯 Required tanks: ${Object.keys(tankData).filter(id => tankData[id].status === 'مطلوبة').join(', ')}`);
        });
    </script>
</body>
</html>