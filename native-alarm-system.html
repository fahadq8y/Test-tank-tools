<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù†Ø¨Ù‡ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .alarm-form {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #FFD700;
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 16px;
        }
        
        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .time-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
            min-width: 200px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(45deg, #FF9800, #F57C00);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .platform-detection {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .status-message {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
        
        .success { background: rgba(76, 175, 80, 0.2); border-left: 4px solid #4CAF50; }
        .error { background: rgba(244, 67, 54, 0.2); border-left: 4px solid #F44336; }
        .info { background: rgba(33, 150, 243, 0.2); border-left: 4px solid #2196F3; }
        .warning { background: rgba(255, 152, 0, 0.2); border-left: 4px solid #FF9800; }
        
        .quick-times {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        
        .quick-time-btn {
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .quick-time-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .alarm-preview {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .time-inputs {
                grid-template-columns: 1fr;
            }
            
            .btn {
                width: 100%;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>â° Ù…Ù†Ø¨Ù‡ Ø§Ù„Ø¬ÙˆØ§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h1>
            <p>ÙŠÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø¨Ù‡ ÙÙŠ Ø¬ÙˆØ§Ù„Ùƒ Ù…Ø¨Ø§Ø´Ø±Ø©!</p>
        </div>

        <div class="platform-detection" id="platformInfo">
            <h3>ğŸ” Ø§ÙƒØªØ´Ø§Ù Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²...</h3>
            <p id="deviceType">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</p>
        </div>

        <div class="alarm-form">
            <h3>ğŸš¨ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù†Ø¨Ù‡</h3>
            
            <div class="form-group">
                <label class="form-label">ğŸ“ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†Ø¨Ù‡:</label>
                <input type="text" id="alarmTitle" class="form-input" placeholder="Ù…Ø«Ø§Ù„: ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©" value="ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù…Ù„ Ù…Ù‡Ù…">
            </div>
            
            <div class="form-group">
                <label class="form-label">ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©:</label>
                <textarea id="alarmDescription" class="form-textarea" placeholder="Ø£ÙŠ ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ù…Ù†Ø¨Ù‡..."></textarea>
            </div>
            
            <div class="form-group">
                <label class="form-label">â° ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø¨Ù‡:</label>
                <div class="time-inputs">
                    <input type="time" id="alarmTime" class="form-input">
                    <input type="date" id="alarmDate" class="form-input">
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">ğŸ”” Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†Ø¨Ù‡:</label>
                <select id="alarmType" class="form-select">
                    <option value="normal">Ø¹Ø§Ø¯ÙŠ</option>
                    <option value="important">Ù…Ù‡Ù…</option>
                    <option value="urgent">Ø¹Ø§Ø¬Ù„</option>
                    <option value="critical">Ø­Ø±Ø¬</option>
                </select>
            </div>

            <h4>âš¡ Ø£ÙˆÙ‚Ø§Øª Ø³Ø±ÙŠØ¹Ø©:</h4>
            <div class="quick-times">
                <button class="quick-time-btn" onclick="setQuickTime(5)">Ø¨Ø¹Ø¯ 5 Ø¯Ù‚Ø§Ø¦Ù‚</button>
                <button class="quick-time-btn" onclick="setQuickTime(15)">Ø¨Ø¹Ø¯ 15 Ø¯Ù‚ÙŠÙ‚Ø©</button>
                <button class="quick-time-btn" onclick="setQuickTime(30)">Ø¨Ø¹Ø¯ 30 Ø¯Ù‚ÙŠÙ‚Ø©</button>
                <button class="quick-time-btn" onclick="setQuickTime(60)">Ø¨Ø¹Ø¯ Ø³Ø§Ø¹Ø©</button>
            </div>

            <div class="alarm-preview" id="alarmPreview" style="display: none;">
                <h4>ğŸ“‹ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù†Ø¨Ù‡:</h4>
                <div id="previewContent"></div>
            </div>
        </div>

        <div style="text-align: center;">
            <button class="btn btn-primary" onclick="createNativeAlarm()">
                ğŸ“± ÙØªØ­ Ù…Ù†Ø¨Ù‡ Ø§Ù„Ø¬ÙˆØ§Ù„
            </button>
            
            <button class="btn btn-secondary" onclick="createCalendarEvent()">
                ğŸ“… Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØªÙ‚ÙˆÙŠÙ…
            </button>
            
            <button class="btn btn-warning" onclick="testAlarmMethods()">
                ğŸ”§ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ø±Ù‚
            </button>
            
            <button class="btn btn-secondary" onclick="tryManualDeepLinks()">
                ğŸ”— ØªØ¬Ø±Ø¨Ø© Ø±ÙˆØ§Ø¨Ø· ÙŠØ¯ÙˆÙŠØ©
            </button>
            
            <button class="btn" style="background: linear-gradient(45deg, #9C27B0, #673AB7); color: white;" onclick="tryWebAlarmAPI()">
                ğŸŒ Ù…Ù†Ø¨Ù‡ ÙˆÙŠØ¨ Ù…Ø¨Ø§Ø´Ø±
            </button>
        </div>

        <div id="statusMessages"></div>
        
        <div style="margin-top: 30px; padding: 20px; background: rgba(0,0,0,0.2); border-radius: 10px;">
            <h4>ğŸ“– Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</h4>
            <ol style="text-align: right; line-height: 1.8;">
                <li>Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†Ø¨Ù‡ ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</li>
                <li>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†Ø¨Ù‡ (Ø¹Ø§Ø¯ÙŠ Ø£Ùˆ Ù…Ù‡Ù… Ø£Ùˆ Ø¹Ø§Ø¬Ù„)</li>
                <li>Ø§Ø¶ØºØ· "ÙØªØ­ Ù…Ù†Ø¨Ù‡ Ø§Ù„Ø¬ÙˆØ§Ù„" - Ø³ÙŠÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø¨Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø©</li>
                <li>Ø£ÙƒÙ…Ù„ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù†Ø¨Ù‡ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ø­ÙØ¸Ù‡</li>
                <li>Ø§Ù„Ù…Ù†Ø¨Ù‡ Ø³ÙŠØ¹Ù…Ù„ Ø­ØªÙ‰ Ù„Ùˆ ÙƒØ§Ù† Ø§Ù„Ø¬ÙˆØ§Ù„ Ù…Ù‚ÙÙ„!</li>
            </ol>
        </div>
    </div>

    <script>
        // ÙƒØ´Ù Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²
        function detectDevice() {
            const userAgent = navigator.userAgent.toLowerCase();
            const platform = navigator.platform.toLowerCase();
            
            let deviceInfo = {
                type: 'unknown',
                os: 'unknown',
                browser: 'unknown',
                canUseDeepLinks: false
            };
            
            // ÙƒØ´Ù iOS
            if (/iphone|ipad|ipod/.test(userAgent) || (platform.includes('mac') && 'ontouchend' in document)) {
                deviceInfo.type = 'iOS';
                deviceInfo.os = 'iOS';
                deviceInfo.canUseDeepLinks = true;
            }
            // ÙƒØ´Ù Android  
            else if (/android/.test(userAgent)) {
                deviceInfo.type = 'Android';
                deviceInfo.os = 'Android';
                deviceInfo.canUseDeepLinks = true;
            }
            // ÙƒØ´Ù Windows
            else if (/windows/.test(userAgent)) {
                deviceInfo.type = 'Desktop';
                deviceInfo.os = 'Windows';
                deviceInfo.canUseDeepLinks = false;
            }
            // ÙƒØ´Ù Mac
            else if (/mac/.test(userAgent)) {
                deviceInfo.type = 'Desktop';
                deviceInfo.os = 'macOS';
                deviceInfo.canUseDeepLinks = false;
            }
            
            // ÙƒØ´Ù Ø§Ù„Ù…ØªØµÙØ­
            if (/chrome/.test(userAgent)) deviceInfo.browser = 'Chrome';
            else if (/safari/.test(userAgent)) deviceInfo.browser = 'Safari';
            else if (/firefox/.test(userAgent)) deviceInfo.browser = 'Firefox';
            else if (/edge/.test(userAgent)) deviceInfo.browser = 'Edge';
            
            return deviceInfo;
        }
        
        // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²
        function displayDeviceInfo() {
            const device = detectDevice();
            const platformDiv = document.getElementById('platformInfo');
            const deviceTypeSpan = document.getElementById('deviceType');
            
            let statusColor = device.canUseDeepLinks ? '#4CAF50' : '#FF9800';
            let statusText = device.canUseDeepLinks ? 'âœ… Ù…Ø¯Ø¹ÙˆÙ…' : 'âš ï¸ Ù…Ø­Ø¯ÙˆØ¯';
            
            deviceTypeSpan.innerHTML = `
                <strong>Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²:</strong> ${device.type}<br>
                <strong>Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„:</strong> ${device.os}<br>
                <strong>Ø§Ù„Ù…ØªØµÙØ­:</strong> ${device.browser}<br>
                <strong style="color: ${statusColor};">ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª: ${statusText}</strong>
            `;
            
            return device;
        }
        
        // ØªØ¹ÙŠÙŠÙ† ÙˆÙ‚Øª Ø³Ø±ÙŠØ¹
        function setQuickTime(minutes) {
            const now = new Date();
            const futureTime = new Date(now.getTime() + minutes * 60000);
            
            document.getElementById('alarmTime').value = futureTime.toTimeString().slice(0, 5);
            document.getElementById('alarmDate').value = futureTime.toISOString().slice(0, 10);
            
            updateAlarmPreview();
            showMessage(`ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ù†Ø¨Ù‡ Ø¨Ø¹Ø¯ ${minutes} Ø¯Ù‚ÙŠÙ‚Ø©`, 'success');
        }
        
        // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù†Ø¨Ù‡
        function updateAlarmPreview() {
            const title = document.getElementById('alarmTitle').value;
            const time = document.getElementById('alarmTime').value;
            const date = document.getElementById('alarmDate').value;
            const type = document.getElementById('alarmType').value;
            
            if (title && time && date) {
                const alarmDateTime = new Date(`${date}T${time}`);
                const now = new Date();
                const diff = alarmDateTime - now;
                
                let timeUntil = '';
                if (diff > 0) {
                    const hours = Math.floor(diff / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    timeUntil = `Ø¨Ø¹Ø¯ ${hours} Ø³Ø§Ø¹Ø© Ùˆ ${minutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
                } else {
                    timeUntil = 'ÙÙŠ Ø§Ù„Ù…Ø§Ø¶ÙŠ âš ï¸';
                }
                
                const typeIcons = {
                    normal: 'ğŸ”µ',
                    important: 'ğŸŸ¡', 
                    urgent: 'ğŸ”´',
                    critical: 'ğŸš¨'
                };
                
                document.getElementById('previewContent').innerHTML = `
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <p><strong>${typeIcons[type]} ${title}</strong></p>
                        <p>ğŸ“… ${alarmDateTime.toLocaleDateString('ar-SA')}</p>
                        <p>â° ${alarmDateTime.toLocaleTimeString('ar-SA')}</p>
                        <p>â³ ${timeUntil}</p>
                    </div>
                `;
                
                document.getElementById('alarmPreview').style.display = 'block';
            } else {
                document.getElementById('alarmPreview').style.display = 'none';
            }
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø¨Ù‡ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£ØµÙ„ÙŠ
        function createNativeAlarm() {
            const device = detectDevice();
            const title = document.getElementById('alarmTitle').value;
            const time = document.getElementById('alarmTime').value;
            const date = document.getElementById('alarmDate').value;
            const description = document.getElementById('alarmDescription').value;
            
            if (!title || !time || !date) {
                showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            const alarmDateTime = new Date(`${date}T${time}`);
            const hours = alarmDateTime.getHours();
            const minutes = alarmDateTime.getMinutes();
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¹Ø¯Ø© Ø·Ø±Ù‚ Ù…ØªØªØ§Ù„ÙŠØ©
            showMessage('ğŸ”„ Ø¬Ø§Ø±ÙŠ Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø¨Ù‡...', 'info');
            
            if (device.type === 'iOS') {
                tryiOSAlarmMethods(title, alarmDateTime, hours, minutes);
            } else if (device.type === 'Android') {
                tryAndroidAlarmMethods(title, alarmDateTime, hours, minutes);
            } else {
                showMessage('Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø² Ù„Ø§ ÙŠØ¯Ø¹Ù… ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¬ÙˆØ§Ù„. Ø¬Ø±Ø¨ "Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØªÙ‚ÙˆÙŠÙ…" Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„Ùƒ', 'warning');
                return;
            }
        }
        
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø·Ø±Ù‚ iOS Ù…ØªØ¹Ø¯Ø¯Ø©
        function tryiOSAlarmMethods(title, dateTime, hours, minutes) {
            const methods = [
                // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - Clock App
                `clock-alarm://new?at=${dateTime.toISOString()}&label=${encodeURIComponent(title)}`,
                // Ø·Ø±Ù‚ Ø£Ø®Ø±Ù‰
                `clock://`,
                `x-apple-clock://alarm`,
                `prefs:root=SOUNDS&path=Ringtone`,
                // Shortcuts app
                `shortcuts://run-shortcut?name=CreateAlarm&input=${encodeURIComponent(title)}`
            ];
            
            let currentMethod = 0;
            
            function tryNextMethod() {
                if (currentMethod >= methods.length) {
                    // ÙØ´Ù„Øª ÙƒÙ„ Ø§Ù„Ø·Ø±Ù‚
                    showMessage('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªØ·Ø¨ÙŠÙ‚ Ù…Ù†Ø¨Ù‡ Ù…ØªÙˆØ§ÙÙ‚. Ø³Ù†Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ©', 'warning');
                    showAlarmInstructions(title, dateTime);
                    return;
                }
                
                const deepLink = methods[currentMethod];
                showMessage(`ğŸ”„ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ${currentMethod + 1}/${methods.length}: ${getMethodName(deepLink)}`, 'info');
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Deep Link
                const link = document.createElement('a');
                link.href = deepLink;
                link.style.display = 'none';
                document.body.appendChild(link);
                
                // Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­
                const startTime = Date.now();
                const successTimer = setTimeout(() => {
                    const elapsed = Date.now() - startTime;
                    if (elapsed >= 1500) {
                        // Ù†Ø¬Ø­ ÙÙŠ Ø§Ù„ÙØªØ­ (Ø§Ù„Ù…ØªØµÙØ­ ØªÙˆÙ‚Ù Ù„ÙØªØ±Ø©)
                        showMessage('âœ… ØªÙ… ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚! Ø£ÙƒÙ…Ù„ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù†Ø¨Ù‡ ÙˆØ§Ø­ÙØ¸Ù‡', 'success');
                        document.body.removeChild(link);
                        return;
                    }
                }, 1500);
                
                // Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„ÙØ´Ù„
                const failTimer = setTimeout(() => {
                    clearTimeout(successTimer);
                    document.body.removeChild(link);
                    currentMethod++;
                    setTimeout(tryNextMethod, 500); // ØªØ£Ø®ÙŠØ± Ù‚ØµÙŠØ± Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª
                }, 800);
                
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„ØªØºÙŠÙŠØ± ØµÙØ­Ø© (ÙŠØ¹Ù†ÙŠ Ù†Ø¬Ø­ Ø§Ù„ÙØªØ­)
                const visibilityHandler = () => {
                    if (document.visibilityState === 'hidden') {
                        clearTimeout(failTimer);
                        clearTimeout(successTimer);
                        showMessage('âœ… ØªÙ… ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚! Ø£ÙƒÙ…Ù„ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù†Ø¨Ù‡ ÙˆØ§Ø­ÙØ¸Ù‡', 'success');
                        document.removeEventListener('visibilitychange', visibilityHandler);
                        if (link.parentNode) document.body.removeChild(link);
                    }
                };
                document.addEventListener('visibilitychange', visibilityHandler);
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·
                try {
                    link.click();
                } catch (error) {
                    clearTimeout(successTimer);
                    clearTimeout(failTimer);
                    document.removeEventListener('visibilitychange', visibilityHandler);
                    if (link.parentNode) document.body.removeChild(link);
                    currentMethod++;
                    setTimeout(tryNextMethod, 500);
                }
            }
            
            tryNextMethod();
        }
        
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø·Ø±Ù‚ Android Ù…ØªØ¹Ø¯Ø¯Ø©  
        function tryAndroidAlarmMethods(title, dateTime, hours, minutes) {
            const methods = [
                // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© - Android Standard SET_ALARM
                `intent:#Intent;action=android.intent.action.SET_ALARM;i.android.intent.extra.alarm.HOUR=${hours};i.android.intent.extra.alarm.MINUTES=${minutes};S.android.intent.extra.alarm.MESSAGE=${encodeURIComponent(title)};end`,
                
                // Google Clock Ø¨Ø¯ÙˆÙ† package Ù…Ø­Ø¯Ø¯
                `intent:#Intent;action=android.intent.action.SET_ALARM;i.android.intent.extra.alarm.HOUR=${hours};i.android.intent.extra.alarm.MINUTES=${minutes};S.android.intent.extra.alarm.MESSAGE=${encodeURIComponent(title)};S.android.intent.extra.alarm.SKIP_UI=false;end`,
                
                // ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø§Ø¹Ø© ÙÙ‚Ø· Ø«Ù… Ø¥Ø¹Ø¯Ø§Ø¯ ÙŠØ¯ÙˆÙŠ
                `intent:#Intent;action=android.intent.action.SHOW_ALARMS;end`,
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¹ Google Clock ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø«Ø¨Øª
                `intent://com.google.android.deskclock/alarms#Intent;scheme=android-app;end`,
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¹Ø§Ù…Ø© Ù„ÙØªØ­ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø¨Ù‡Ø§Øª
                `intent:#Intent;action=android.intent.action.SHOW_ALARMS;category=android.intent.category.DEFAULT;end`,
                
                // Ø·Ø±ÙŠÙ‚Ø© Web Intent API
                `https://clock.google.com/alarm/set?hour=${hours}&minute=${minutes}&label=${encodeURIComponent(title)}`
            ];
            
            let currentMethod = 0;
            
            function tryNextMethod() {
                if (currentMethod >= methods.length) {
                    // ÙØ´Ù„Øª ÙƒÙ„ Ø§Ù„Ø·Ø±Ù‚
                    showMessage('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªØ·Ø¨ÙŠÙ‚ Ù…Ù†Ø¨Ù‡ Ù…ØªÙˆØ§ÙÙ‚. Ø³Ù†Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ©', 'warning');
                    showAlarmInstructions(title, dateTime);
                    return;
                }
                
                const deepLink = methods[currentMethod];
                showMessage(`ğŸ”„ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ${currentMethod + 1}/${methods.length}: ${getAndroidMethodName(deepLink)}`, 'info');
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Deep Link Ù…Ø¹ iframe Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø±Ø§Ø¨Ø·
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = deepLink;
                document.body.appendChild(iframe);
                
                // Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­/Ø§Ù„ÙØ´Ù„
                let resolved = false;
                
                const cleanup = () => {
                    if (iframe.parentNode) {
                        document.body.removeChild(iframe);
                    }
                };
                
                // Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­ - Ø¥Ø°Ø§ Ø§Ø®ØªÙØª Ø§Ù„ØµÙØ­Ø© ÙŠØ¹Ù†ÙŠ Ù†Ø¬Ø­
                const visibilityHandler = () => {
                    if (!resolved && document.visibilityState === 'hidden') {
                        resolved = true;
                        showMessage('âœ… ØªÙ… ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚! Ø£ÙƒÙ…Ù„ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù†Ø¨Ù‡ ÙˆØ§Ø­ÙØ¸Ù‡', 'success');
                        cleanup();
                        document.removeEventListener('visibilitychange', visibilityHandler);
                    }
                };
                document.addEventListener('visibilitychange', visibilityHandler);
                
                // Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„ÙØ´Ù„
                setTimeout(() => {
                    if (!resolved) {
                        resolved = true;
                        document.removeEventListener('visibilitychange', visibilityHandler);
                        cleanup();
                        currentMethod++;
                        
                        if (currentMethod < methods.length) {
                            setTimeout(tryNextMethod, 800);
                        } else {
                            showMessage('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªØ·Ø¨ÙŠÙ‚ Ù…Ù†Ø¨Ù‡ Ù…ØªÙˆØ§ÙÙ‚. Ø³Ù†Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ©', 'warning');
                            showAlarmInstructions(title, dateTime);
                        }
                    }
                }, 2000);
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø£ÙŠØ¶Ø§Ù‹ Ø¨Ø·Ø±ÙŠÙ‚Ø© window.location ÙƒÙ†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
                setTimeout(() => {
                    if (!resolved) {
                        try {
                            window.location.href = deepLink;
                        } catch (e) {
                            console.log('Window location method failed:', e);
                        }
                    }
                }, 500);
            }
            
            tryNextMethod();
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©
        function getMethodName(url) {
            if (url.includes('clock-alarm://')) return 'ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ';
            if (url.includes('clock://')) return 'ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø¹Ø§Ù…';
            if (url.includes('shortcuts://')) return 'ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª';
            if (url.includes('prefs:')) return 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…';
            return 'Ø·Ø±ÙŠÙ‚Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©';
        }
        
        function getAndroidMethodName(url) {
            if (url.includes('com.google.android.deskclock')) return 'Google Clock';
            if (url.includes('com.samsung.android.app.clockpackage')) return 'Samsung Clock';
            if (url.includes('com.android.deskclock')) return 'Android Clock';
            if (url.includes('android-app://')) return 'Android App Link';
            return 'Android Standard Intent';
        }
        
        // Ø¹Ø±Ø¶ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ù†Ø¨Ù‡ Ø§Ù„ÙŠØ¯ÙˆÙŠ
        function showAlarmInstructions(title, dateTime) {
            const instructions = `
                <div style="background: rgba(255,152,0,0.2); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h4>ğŸ“± ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙŠØ¯ÙˆÙŠ:</h4>
                    <ol style="text-align: right; line-height: 2;">
                        <li>Ø§ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø§Ø¹Ø© ÙÙŠ Ø¬ÙˆØ§Ù„Ùƒ</li>
                        <li>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ù…Ù†Ø¨Ù‡" Ø£Ùˆ "Alarm"</li>
                        <li>Ø§Ø¶ØºØ· "+" Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø¨Ù‡ Ø¬Ø¯ÙŠØ¯</li>
                        <li>Ø§Ø¶Ø¨Ø· Ø§Ù„ÙˆÙ‚Øª: ${dateTime.toLocaleTimeString('ar-SA')}</li>
                        <li>Ø§Ø¶Ø¨Ø· Ø§Ù„ØªØ§Ø±ÙŠØ®: ${dateTime.toLocaleDateString('ar-SA')}</li>
                        <li>Ø£Ø¶Ù Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${title}</li>
                        <li>Ø§Ø­ÙØ¸ Ø§Ù„Ù…Ù†Ø¨Ù‡</li>
                    </ol>
                </div>
            `;
            
            document.getElementById('statusMessages').innerHTML += instructions;
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø¯Ø« ØªÙ‚ÙˆÙŠÙ…
        function createCalendarEvent() {
            const title = document.getElementById('alarmTitle').value;
            const time = document.getElementById('alarmTime').value;
            const date = document.getElementById('alarmDate').value;
            const description = document.getElementById('alarmDescription').value;
            const type = document.getElementById('alarmType').value;
            
            if (!title || !time || !date) {
                showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            const alarmDateTime = new Date(`${date}T${time}`);
            const endDateTime = new Date(alarmDateTime.getTime() + 5 * 60000); // 5 Ø¯Ù‚Ø§Ø¦Ù‚
            
            // ØªØ­Ø¯ÙŠØ¯ Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
            const alertSettings = {
                normal: ['-PT0M'],
                important: ['-PT0M', '-PT5M'],
                urgent: ['-PT0M', '-PT5M', '-PT15M'],
                critical: ['-PT0M', '-PT1M', '-PT5M', '-PT15M']
            };
            
            const alerts = alertSettings[type].map(trigger => `
BEGIN:VALARM
TRIGGER:${trigger}
ACTION:DISPLAY
DESCRIPTION:${title}
END:VALARM
BEGIN:VALARM
TRIGGER:${trigger}
ACTION:AUDIO
ATTACH;VALUE=URI:Alarm
END:VALARM`).join('\n');
            
            const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Tank Tools//Work Alarm//EN
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
UID:${Date.now()}@tanktools.work
DTSTART:${formatICS(alarmDateTime)}
DTEND:${formatICS(endDateTime)}
SUMMARY:ğŸš¨ ${title}
DESCRIPTION:ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù…Ù„ - ${type.toUpperCase()}\\n\\n${description}
CATEGORIES:WORK,ALARM,${type.toUpperCase()}
STATUS:CONFIRMED
TRANSP:OPAQUE
PRIORITY:${type === 'critical' ? 1 : type === 'urgent' ? 3 : type === 'important' ? 5 : 9}
${alerts}
END:VEVENT
END:VCALENDAR`;
            
            // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù ICS
            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `work-alarm-${Date.now()}.ics`;
            link.click();
            
            showMessage('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„ØªÙ‚ÙˆÙŠÙ…. Ø§ÙØªØ­Ù‡ Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†Ø¨Ù‡ Ù„Ù„ØªÙ‚ÙˆÙŠÙ…', 'success');
            
            // ØªÙ†Ø¸ÙŠÙ
            setTimeout(() => URL.revokeObjectURL(url), 1000);
        }
        
        // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù„Ù€ ICS
        function formatICS(date) {
            return date.toISOString().replace(/[-:]/g, '').replace(/\.\d{3}/, '');
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ø±Ù‚
        function testAlarmMethods() {
            showMessage('ğŸ”§ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø·Ø±Ù‚ Ø§Ù„Ù…Ù†Ø¨Ù‡...', 'info');
            
            const device = detectDevice();
            let testResults = `
                <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h4>ğŸ§ª Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙØµÙ„Ø©:</h4>
                    <div style="text-align: right; line-height: 1.8;">
                        <h5>ğŸ“± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²:</h5>
                        <ul>
                            <li><strong>Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²:</strong> ${device.type}</li>
                            <li><strong>Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„:</strong> ${device.os}</li>
                            <li><strong>Ø§Ù„Ù…ØªØµÙØ­:</strong> ${device.browser}</li>
                            <li><strong>User Agent:</strong> <code style="font-size: 0.8em;">${navigator.userAgent}</code></li>
                        </ul>
                        
                        <h5>ğŸ”— Ø¥Ù…ÙƒØ§Ù†ÙŠØ§Øª Deep Links:</h5>
                        <ul>
            `;
            
            // Ø§Ø®ØªØ¨Ø§Ø± Deep Links
            testResults += `<li>ğŸ“± ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙˆÙ„: ${device.canUseDeepLinks ? 'âœ… Ù…Ø¯Ø¹ÙˆÙ… Ù†Ø¸Ø±ÙŠØ§Ù‹' : 'âŒ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'}</li>`;
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
            if (device.type === 'Android') {
                const androidMethods = [
                    'Google Clock App',
                    'Samsung Clock App', 
                    'AOSP Clock App',
                    'Android Standard Intents',
                    'Android App Links'
                ];
                
                androidMethods.forEach(method => {
                    testResults += `<li>ğŸ¤– ${method}: Ø³ÙŠØªÙ… Ø§Ø®ØªØ¨Ø§Ø±Ù‡</li>`;
                });
            } else if (device.type === 'iOS') {
                const iosMethods = [
                    'iOS Clock App',
                    'iOS Settings',
                    'iOS Shortcuts App'
                ];
                
                iosMethods.forEach(method => {
                    testResults += `<li>ğŸ ${method}: Ø³ÙŠØªÙ… Ø§Ø®ØªØ¨Ø§Ø±Ù‡</li>`;
                });
            }
            
            testResults += `</ul>
                        
                        <h5>ğŸ› ï¸ Ø¥Ù…ÙƒØ§Ù†ÙŠØ§Øª Ø£Ø®Ø±Ù‰:</h5>
                        <ul>`;
            
            // Ø§Ø®ØªØ¨Ø§Ø± Calendar
            testResults += `<li>ğŸ“… Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙ‚ÙˆÙŠÙ… (ICS): âœ… Ù…Ø¯Ø¹ÙˆÙ…</li>`;
            
            // Ø§Ø®ØªØ¨Ø§Ø± Notifications
            testResults += `<li>ğŸ”” ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…ØªØµÙØ­: ${'Notification' in window ? 'âœ… Ù…Ø¯Ø¹ÙˆÙ…' : 'âŒ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'}</li>`;
            
            // Ø§Ø®ØªØ¨Ø§Ø± Vibration
            testResults += `<li>ğŸ“³ Ø§Ù„Ø§Ù‡ØªØ²Ø§Ø²: ${navigator.vibrate ? 'âœ… Ù…Ø¯Ø¹ÙˆÙ…' : 'âŒ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'}</li>`;
            
            // Ø§Ø®ØªØ¨Ø§Ø± localStorage
            testResults += `<li>ğŸ’¾ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ: ${typeof(Storage) !== "undefined" ? 'âœ… Ù…Ø¯Ø¹ÙˆÙ…' : 'âŒ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'}</li>`;
            
            // Ø§Ø®ØªØ¨Ø§Ø± Service Worker
            testResults += `<li>âš™ï¸ Service Worker: ${'serviceWorker' in navigator ? 'âœ… Ù…Ø¯Ø¹ÙˆÙ…' : 'âŒ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'}</li>`;
            
            testResults += `</ul>
                    </div>
                </div>
                
                <div style="background: rgba(255,152,0,0.1); padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <h5>ğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù:</h5>
                    <ol style="text-align: right; line-height: 1.8;">
                        <li>Ø¥Ø°Ø§ Ø¸Ù‡Ø± "Item not found"ØŒ Ø¬Ø±Ø¨ ØªØ·Ø¨ÙŠÙ‚ Ø³Ø§Ø¹Ø© Ù…Ø®ØªÙ„Ù</li>
                        <li>ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ JavaScript ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­</li>
                        <li>Ø¨Ø¹Ø¶ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª ØªØ­Ø¬Ø¨ Deep Links Ù„Ù„Ø£Ù…Ø§Ù†</li>
                        <li>Ø§Ø³ØªØ®Ø¯Ù… "Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØªÙ‚ÙˆÙŠÙ…" ÙƒØ¨Ø¯ÙŠÙ„ Ù…Ø¶Ù…ÙˆÙ†</li>
                        <li>ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ù†Ø¨Ù‡ Ø§Ù„Ù…Ø®ØªÙ„ÙØ© Ù„Ù‡Ø§ Ø±ÙˆØ§Ø¨Ø· Ù…Ø®ØªÙ„ÙØ©</li>
                    </ol>
                </div>`;
            
            document.getElementById('statusMessages').innerHTML = testResults;
            
            // Ø§Ø®ØªØ¨Ø§Ø± ØªØ·Ø¨ÙŠÙ‚ÙŠ Ù„Ù„Ù€ Deep Links
            if (device.canUseDeepLinks) {
                setTimeout(() => {
                    testActualDeepLinks(device);
                }, 2000);
            }
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± ØªØ·Ø¨ÙŠÙ‚ÙŠ Ù„Ù„Ù€ Deep Links
        function testActualDeepLinks(device) {
            showMessage('ğŸ”¬ Ø§Ø®ØªØ¨Ø§Ø± Deep Links ØªØ·Ø¨ÙŠÙ‚ÙŠØ§Ù‹...', 'info');
            
            const testTitle = 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù†Ø¨Ù‡';
            const testTime = new Date();
            testTime.setMinutes(testTime.getMinutes() + 5);
            
            let testLinks = [];
            
            if (device.type === 'Android') {
                testLinks = [
                    {
                        name: 'Google Clock Standard',
                        url: `intent://alarm?hour=${testTime.getHours()}&minutes=${testTime.getMinutes()}&message=${encodeURIComponent(testTitle)}#Intent;scheme=android.intent.action.SET_ALARM;package=com.google.android.deskclock;end`
                    },
                    {
                        name: 'Samsung Clock',
                        url: `intent://alarm?hour=${testTime.getHours()}&minutes=${testTime.getMinutes()}&message=${encodeURIComponent(testTitle)}#Intent;scheme=android.intent.action.SET_ALARM;package=com.samsung.android.app.clockpackage;end`
                    },
                    {
                        name: 'Android Generic',
                        url: `intent:#Intent;action=android.intent.action.SET_ALARM;i.android.intent.extra.alarm.HOUR=${testTime.getHours()};i.android.intent.extra.alarm.MINUTES=${testTime.getMinutes()};S.android.intent.extra.alarm.MESSAGE=${testTitle};end`
                    }
                ];
            } else if (device.type === 'iOS') {
                testLinks = [
                    {
                        name: 'iOS Clock App',
                        url: `clock-alarm://new?at=${testTime.toISOString()}&label=${encodeURIComponent(testTitle)}`
                    },
                    {
                        name: 'iOS Clock Generic',
                        url: `clock://`
                    }
                ];
            }
            
            let testIndex = 0;
            
            function runNextTest() {
                if (testIndex >= testLinks.length) {
                    showMessage('âœ… Ø§Ù†ØªÙ‡Ù‰ Ø§Ø®ØªØ¨Ø§Ø± Deep Links. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø£Ø¹Ù„Ø§Ù‡', 'info');
                    return;
                }
                
                const test = testLinks[testIndex];
                showMessage(`ğŸ” Ø§Ø®ØªØ¨Ø§Ø±: ${test.name}`, 'info');
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = test.url;
                document.body.appendChild(iframe);
                
                let testResolved = false;
                
                // Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­
                const successHandler = () => {
                    if (!testResolved && document.visibilityState === 'hidden') {
                        testResolved = true;
                        showMessage(`âœ… ${test.name}: Ù†Ø¬Ø­!`, 'success');
                        document.removeEventListener('visibilitychange', successHandler);
                        if (iframe.parentNode) document.body.removeChild(iframe);
                    }
                };
                document.addEventListener('visibilitychange', successHandler);
                
                // Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„ÙØ´Ù„
                setTimeout(() => {
                    if (!testResolved) {
                        testResolved = true;
                        showMessage(`âŒ ${test.name}: Ù„Ù… ÙŠÙ†Ø¬Ø­`, 'error');
                        document.removeEventListener('visibilitychange', successHandler);
                        if (iframe.parentNode) document.body.removeChild(iframe);
                    }
                    
                    testIndex++;
                    setTimeout(runNextTest, 1000);
                }, 3000);
            }
            
            runNextTest();
        }
        
        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø­Ø§Ù„Ø©
        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `status-message ${type}`;
            messageDiv.textContent = message;
            
            document.getElementById('statusMessages').appendChild(messageDiv);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.remove();
                }
            }, 5000);
        }
        
        // Ù…Ù†Ø¨Ù‡ ÙˆÙŠØ¨ Ù…Ø¨Ø§Ø´Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Web APIs
        function tryWebAlarmAPI() {
            const title = document.getElementById('alarmTitle').value;
            const time = document.getElementById('alarmTime').value;
            const date = document.getElementById('alarmDate').value;
            const description = document.getElementById('alarmDescription').value;
            
            if (!title || !time || !date) {
                showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            const alarmDateTime = new Date(`${date}T${time}`);
            const now = new Date();
            
            if (alarmDateTime <= now) {
                showMessage('ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø¨Ù‡ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„', 'error');
                return;
            }
            
            showMessage('ğŸŒ Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ù†Ø¨Ù‡ Ø§Ù„ÙˆÙŠØ¨...', 'info');
            
            // 1. Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Notification API
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        const timeUntilAlarm = alarmDateTime.getTime() - now.getTime();
                        
                        showMessage(`âœ… ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„ÙˆÙŠØ¨! Ø³ÙŠÙ†Ø¨Ù‡Ùƒ Ø¨Ø¹Ø¯ ${Math.round(timeUntilAlarm / 60000)} Ø¯Ù‚ÙŠÙ‚Ø©`, 'success');
                        
                        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
                        setTimeout(() => {
                            // ØªØ´ØºÙŠÙ„ Ø¹Ø¯Ø© ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…ØªØªØ§Ù„ÙŠØ©
                            for (let i = 0; i < 5; i++) {
                                setTimeout(() => {
                                    new Notification(`ğŸš¨ ${title}`, {
                                        body: `${description}\nâ° ${alarmDateTime.toLocaleString('ar-SA')}`,
                                        icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23ff4444"/><text x="50" y="60" text-anchor="middle" font-size="40" fill="white">â°</text></svg>',
                                        tag: 'work-alarm',
                                        requireInteraction: true,
                                        vibrate: [200, 100, 200, 100, 200, 100, 200]
                                    });
                                    
                                    // Ø§Ù‡ØªØ²Ø§Ø² Ø¥Ø¶Ø§ÙÙŠ
                                    if (navigator.vibrate) {
                                        navigator.vibrate([500, 200, 500, 200, 500]);
                                    }
                                }, i * 2000);
                            }
                            
                            // ØªØ´ØºÙŠÙ„ ØµÙˆØª ØªÙ†Ø¨ÙŠÙ‡
                            playAlarmSound();
                            
                        }, timeUntilAlarm);
                        
                        // Ø­ÙØ¸ ÙÙŠ localStorage Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©
                        const alarmData = {
                            title,
                            description,
                            dateTime: alarmDateTime.toISOString(),
                            created: new Date().toISOString()
                        };
                        
                        let savedAlarms = JSON.parse(localStorage.getItem('webAlarms') || '[]');
                        savedAlarms.push(alarmData);
                        localStorage.setItem('webAlarms', JSON.stringify(savedAlarms));
                        
                        // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†Ø¨Ù‡ Ø§Ù„Ù…Ø­ÙÙˆØ¸
                        displayActiveAlarms();
                        
                    } else {
                        showMessage('ØªÙ… Ø±ÙØ¶ Ø¥Ø°Ù† Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª. ÙØ¹Ù‘Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø¨Ù‡', 'error');
                    }
                });
            } else {
                showMessage('Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­', 'error');
            }
        }
        
        // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ù…Ù†Ø¨Ù‡
        function playAlarmSound() {
            // Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØª ØªÙ†Ø¨ÙŠÙ‡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Web Audio API
            if ('AudioContext' in window || 'webkitAudioContext' in window) {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                const audioContext = new AudioContext();
                
                // ØªØ´ØºÙŠÙ„ Ù†ØºÙ…Ø© ØªÙ†Ø¨ÙŠÙ‡ Ù…ØªÙƒØ±Ø±Ø©
                for (let i = 0; i < 10; i++) {
                    setTimeout(() => {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                        
                        oscillator.start();
                        oscillator.stop(audioContext.currentTime + 0.5);
                    }, i * 1000);
                }
            }
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø¨Ù‡Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
        function displayActiveAlarms() {
            const savedAlarms = JSON.parse(localStorage.getItem('webAlarms') || '[]');
            const now = new Date();
            
            // ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ù†Ø¨Ù‡Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ© ÙÙ‚Ø·
            const futureAlarms = savedAlarms.filter(alarm => new Date(alarm.dateTime) > now);
            
            if (futureAlarms.length > 0) {
                let alarmsList = `
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <h4>â° Ø§Ù„Ù…Ù†Ø¨Ù‡Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©:</h4>
                `;
                
                futureAlarms.forEach((alarm, index) => {
                    const alarmTime = new Date(alarm.dateTime);
                    const timeUntil = alarmTime.getTime() - now.getTime();
                    const hoursUntil = Math.floor(timeUntil / (1000 * 60 * 60));
                    const minutesUntil = Math.floor((timeUntil % (1000 * 60 * 60)) / (1000 * 60));
                    
                    alarmsList += `
                        <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 8px; margin: 10px 0;">
                            <p><strong>${alarm.title}</strong></p>
                            <p>ğŸ“… ${alarmTime.toLocaleDateString('ar-SA')} â° ${alarmTime.toLocaleTimeString('ar-SA')}</p>
                            <p>â³ Ø¨Ø¹Ø¯ ${hoursUntil} Ø³Ø§Ø¹Ø© Ùˆ ${minutesUntil} Ø¯Ù‚ÙŠÙ‚Ø©</p>
                            <button onclick="cancelWebAlarm(${index})" style="background: #f44336; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">
                                âŒ Ø¥Ù„ØºØ§Ø¡
                            </button>
                        </div>
                    `;
                });
                
                alarmsList += '</div>';
                document.getElementById('statusMessages').innerHTML = alarmsList;
            }
        }
        
        // Ø¥Ù„ØºØ§Ø¡ Ù…Ù†Ø¨Ù‡ ÙˆÙŠØ¨
        function cancelWebAlarm(index) {
            let savedAlarms = JSON.parse(localStorage.getItem('webAlarms') || '[]');
            savedAlarms.splice(index, 1);
            localStorage.setItem('webAlarms', JSON.stringify(savedAlarms));
            
            showMessage('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…Ù†Ø¨Ù‡', 'success');
            displayActiveAlarms();
        }
        
        // ØªØ¬Ø±Ø¨Ø© Ø±ÙˆØ§Ø¨Ø· ÙŠØ¯ÙˆÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
        function tryManualDeepLinks() {
            const device = detectDevice();
            
            if (device.type !== 'Android' && device.type !== 'iOS') {
                showMessage('Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© ØªØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø£Ø¬Ù‡Ø²Ø© Android Ùˆ iOS ÙÙ‚Ø·', 'warning');
                return;
            }
            
            const manualLinks = `
                <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h4>ğŸ”— Ø±ÙˆØ§Ø¨Ø· ÙŠØ¯ÙˆÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h4>
                    <p style="margin-bottom: 15px;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø£Ø¯Ù†Ø§Ù‡ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø£ÙŠ Ù…Ù†Ù‡Ø§ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ:</p>
                    
                    ${device.type === 'Android' ? getAndroidManualLinks() : getIOSManualLinks()}
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(255,152,0,0.1); border-radius: 8px;">
                        <p><strong>ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø©:</strong></p>
                        <ul style="text-align: right; line-height: 1.8;">
                            <li>Ø¥Ø°Ø§ Ø¹Ù…Ù„ Ø£ÙŠ Ø±Ø§Ø¨Ø·ØŒ Ø£Ø¹Ù„Ù…Ù†ÙŠ Ø£ÙŠ ÙˆØ§Ø­Ø¯ Ù†Ø¬Ø­</li>
                            <li>Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¹Ù…Ù„ Ø£ÙŠ Ø±Ø§Ø¨Ø·ØŒ Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ù…ØªØµÙØ­ ÙŠØ­Ø¬Ø¨Ù‡Ø§</li>
                            <li>Ø¬Ø±Ø¨ ÙØªØ­ Ø§Ù„ØµÙØ­Ø© ÙÙŠ Ù…ØªØµÙØ­ Ù…Ø®ØªÙ„Ù</li>
                            <li>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ù‡Ùˆ Ø§Ù„Ø¨Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø¶Ù…Ù†</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('statusMessages').innerHTML = manualLinks;
        }
        
        function getAndroidManualLinks() {
            const testHour = 10;
            const testMinutes = 30;
            const testMessage = 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù†Ø¨Ù‡';
            
            return `
                <div style="text-align: right;">
                    <h5>ğŸ¤– Ø±ÙˆØ§Ø¨Ø· Android Ø§Ù„Ù…Ø­Ø¯Ø«Ø©:</h5>
                    <div style="line-height: 2;">
                        <p><strong>1. Android Standard SET_ALARM:</strong></p>
                        <a href="intent:#Intent;action=android.intent.action.SET_ALARM;i.android.intent.extra.alarm.HOUR=${testHour};i.android.intent.extra.alarm.MINUTES=${testMinutes};S.android.intent.extra.alarm.MESSAGE=${encodeURIComponent(testMessage)};end" 
                           style="color: #4CAF50; text-decoration: underline;">
                           ğŸ¯ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© - Ø¬Ø±Ø¨Ù‡Ø§ Ø£ÙˆÙ„Ø§Ù‹
                        </a><br>
                        
                        <p><strong>2. Show Alarms List:</strong></p>
                        <a href="intent:#Intent;action=android.intent.action.SHOW_ALARMS;end" 
                           style="color: #4CAF50; text-decoration: underline;">
                           ğŸ• ÙØªØ­ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø¨Ù‡Ø§Øª (Ø¢Ù…Ù†)
                        </a><br>
                        
                        <p><strong>3. Google Clock Web:</strong></p>
                        <a href="https://clock.google.com/alarm/set?hour=${testHour}&minute=${testMinutes}&label=${encodeURIComponent(testMessage)}" 
                           style="color: #4CAF50; text-decoration: underline;">
                           ğŸŒ Google Clock Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙŠØ¨
                        </a><br>
                        
                        <p><strong>4. Google Clock App Direct:</strong></p>
                        <a href="intent://com.google.android.deskclock/alarms#Intent;scheme=android-app;end" 
                           style="color: #4CAF50; text-decoration: underline;">
                           ğŸ“± Google Clock Ù…Ø¨Ø§Ø´Ø± (Ø¥Ø°Ø§ Ù…Ø«Ø¨Øª)
                        </a><br>
                        
                        <p><strong>5. Simple Open Any Clock:</strong></p>
                        <a href="intent:#Intent;action=android.intent.action.SHOW_ALARMS;category=android.intent.category.DEFAULT;end" 
                           style="color: #4CAF50; text-decoration: underline;">
                           ğŸ”“ Ø£ÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø³Ø§Ø¹Ø© Ù…ØªØ§Ø­
                        </a>
                    </div>
                    
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 10px; border-radius: 8px; margin: 10px 0;">
                        <p><strong>ğŸ’¡ ØªØ¹Ù„ÙŠÙ…Ø§Øª:</strong></p>
                        <ul style="line-height: 1.6;">
                            <li><strong>Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ÙˆÙ„</strong> Ù‡Ùˆ Ø§Ù„Ø£ØµØ­ Ù†Ø¸Ø±ÙŠØ§Ù‹</li>
                            <li><strong>Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø«Ø§Ù†ÙŠ</strong> Ø¢Ù…Ù† ÙˆÙŠÙØªØ­ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø¨Ù‡Ø§Øª</li>
                            <li>Ø¥Ø°Ø§ Ù„Ù… ØªØ¹Ù…Ù„ØŒ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ø£Ùˆ Ø§Ù„Ø£Ù…Ø§Ù†</li>
                            <li>Ø§Ø³ØªØ®Ø¯Ù… <strong>"Ù…Ù†Ø¨Ù‡ ÙˆÙŠØ¨ Ù…Ø¨Ø§Ø´Ø±"</strong> ÙƒØ¨Ø¯ÙŠÙ„</li>
                        </ul>
                    </div>
                </div>
            `;
        }
        
        function getIOSManualLinks() {
            const testTime = new Date();
            testTime.setHours(10, 30, 0, 0);
            const testMessage = 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù†Ø¨Ù‡';
            
            return `
                <div style="text-align: right;">
                    <h5>ğŸ Ø±ÙˆØ§Ø¨Ø· iOS:</h5>
                    <div style="line-height: 2;">
                        <p><strong>1. Clock Alarm:</strong></p>
                        <a href="clock-alarm://new?at=${testTime.toISOString()}&label=${encodeURIComponent(testMessage)}" 
                           style="color: #4CAF50; text-decoration: underline;">
                           iOS Clock Alarm
                        </a><br>
                        
                        <p><strong>2. Clock App:</strong></p>
                        <a href="clock://" 
                           style="color: #4CAF50; text-decoration: underline;">
                           ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Clock
                        </a><br>
                        
                        <p><strong>3. Settings:</strong></p>
                        <a href="prefs:root=SOUNDS&path=Ringtone" 
                           style="color: #4CAF50; text-decoration: underline;">
                           Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ØµÙˆØ§Øª
                        </a><br>
                        
                        <p><strong>4. Shortcuts:</strong></p>
                        <a href="shortcuts://run-shortcut?name=CreateAlarm&input=${encodeURIComponent(testMessage)}" 
                           style="color: #4CAF50; text-decoration: underline;">
                           Shortcuts App
                        </a>
                    </div>
                </div>
            `;
        }
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        window.onload = function() {
            displayDeviceInfo();
            
            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ
            const now = new Date();
            const tomorrow = new Date(now.getTime() + 24 * 60 * 60 * 1000);
            
            document.getElementById('alarmTime').value = '07:00';
            document.getElementById('alarmDate').value = tomorrow.toISOString().slice(0, 10);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
            document.getElementById('alarmTitle').addEventListener('input', updateAlarmPreview);
            document.getElementById('alarmTime').addEventListener('input', updateAlarmPreview);
            document.getElementById('alarmDate').addEventListener('input', updateAlarmPreview);
            document.getElementById('alarmType').addEventListener('change', updateAlarmPreview);
            
            updateAlarmPreview();
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø¨Ù‡Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
            displayActiveAlarms();
        };
    </script>
</body>
</html>