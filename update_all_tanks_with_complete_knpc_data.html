<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø®Ø²Ø§Ù†Ø§Øª PBCR Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ù† Ù†Ø¸Ø§Ù… KNPC</title>
  <style>
    body { font-family: monospace; padding: 20px; background: #1a1a2e; color: #eee; }
    .container { max-width: 1200px; margin: 0 auto; }
    .section { background: #16213e; padding: 20px; margin: 15px 0; border-radius: 8px; }
    .error { border-left: 5px solid #dc3545; }
    .success { border-left: 5px solid #28a745; }
    .warning { border-left: 5px solid #ffc107; }
    .info { border-left: 5px solid #17a2b8; }
    .log { margin: 3px 0; font-size: 14px; }
    .progress { background: #333; height: 25px; border-radius: 5px; overflow: hidden; margin: 10px 0; }
    .progress-bar { background: #28a745; height: 100%; width: 0%; transition: width 0.3s; }
    .tank-summary { display: grid; grid-template-columns: 80px 80px 80px 100px 200px; gap: 10px; padding: 8px; margin: 3px 0; background: #0f1419; border-radius: 4px; font-size: 12px; }
    .tank-id { color: #ffc107; font-weight: bold; }
    .hi-level { color: #17a2b8; }
    .lo-level { color: #6f42c1; }
    .bpm-value { color: #28a745; font-weight: bold; }
    .status { color: #ffc107; }
    .header { background: #2c3e50; font-weight: bold; color: #fff; }
    button { background: #28a745; color: white; border: none; padding: 15px 30px; border-radius: 5px; font-size: 16px; cursor: pointer; margin: 10px 5px; }
    button:hover { background: #218838; }
    .verify-btn { background: #17a2b8; }
    .verify-btn:hover { background: #138496; }
  </style>
</head>
<body>
  <div class="container">
    <div class="section info">
      <h1>ğŸ”§ ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø®Ø²Ø§Ù†Ø§Øª PBCR Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ù† Ù†Ø¸Ø§Ù… KNPC</h1>
      <p>Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ 11 ØµÙˆØ±Ø© Ù…Ù† Ù†Ø¸Ø§Ù… KNPC Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</p>
      <p>Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«: Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¹Ø§Ù„ÙŠ (Hi Level)ØŒ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø®ÙØ¶ (Lo Level)ØŒ ÙˆÙ‚ÙŠÙ…Ø© BPM</p>
    </div>

    <div class="section warning">
      <h2>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø©</h2>
      <div id="dataStats">
        <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª...</p>
      </div>
    </div>

    <div class="section">
      <h2>ğŸ“‹ Ø¹ÙŠÙ†Ø© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø©</h2>
      <div class="tank-summary header">
        <span>Ø±Ù‚Ù… Ø§Ù„Ø®Ø²Ø§Ù†</span>
        <span>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¹Ø§Ù„ÙŠ</span>
        <span>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø®ÙØ¶</span>
        <span>Ù‚ÙŠÙ…Ø© BPM</span>
        <span>Ø§Ù„Ù…ØµØ¯Ø±</span>
      </div>
      <div id="dataSample"></div>
    </div>

    <div class="section">
      <h2>ğŸ¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«</h2>
      <button onclick="verifyCurrentData()" class="verify-btn">
        ğŸ” ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      </button>
      <button onclick="updateAllTanks()">
        ğŸš€ ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø²Ø§Ù†Ø§Øª
      </button>
      <button onclick="showFullDataset()">
        ğŸ“‹ Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      </button>
    </div>

    <div class="section">
      <h2>ğŸ“Š Ø§Ù„ØªÙ‚Ø¯Ù…</h2>
      <div class="progress">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div id="progressText">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡...</div>
    </div>

    <div class="section">
      <h2>ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h2>
      <div id="log"></div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getFirestore, doc, updateDoc, collection, getDocs, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyD7lJcoY33FEC9d6eWy67QIO9SV4lS24pg",
      authDomain: "tank-tools-knpc-c2d95.firebaseapp.com",
      projectId: "tank-tools-knpc-c2d95",
      storageBucket: "tank-tools-knpc-c2d95.firebasestorage.app",
      messagingSenderId: "510062594324",
      appId: "1:510062594324:web:b892fd02007a5ca2f0da01"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ ØµÙˆØ± Ù†Ø¸Ø§Ù… KNPC
    const completeKNPCData = {
      // Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ - Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© B2 EGO
      "600": { hiLevel: 13.300, loLevel: 2.000, bpm: 9490 },
      "601": { hiLevel: 13.300, loLevel: 2.000, bpm: 9490 },
      "602": { hiLevel: 13.730, loLevel: 2.000, bpm: 9512 },
      "603": { hiLevel: 13.325, loLevel: 2.000, bpm: 11695 },
      "605": { hiLevel: 14.325, loLevel: 2.000, bpm: 12964 },
      "633": { hiLevel: 6.000, loLevel: 2.000, bpm: 412 },
      "634": { hiLevel: 6.000, loLevel: 2.000, bpm: 412 },
      "651": { hiLevel: 13.325, loLevel: 2.000, bpm: 6543 },
      "652": { hiLevel: 13.320, loLevel: 2.000, bpm: 6543 },
      "667": { hiLevel: 17.922, loLevel: 2.000, bpm: 12278 },
      "668": { hiLevel: 18.165, loLevel: 2.000, bpm: 16858 },
      "669": { hiLevel: 18.170, loLevel: 2.000, bpm: 16858 },
      "670": { hiLevel: 18.165, loLevel: 2.000, bpm: 16856 },
      "822": { hiLevel: 18.480, loLevel: 1.600, bpm: 16856 },

      // Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© - Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© 3
      "520": { hiLevel: 14.290, loLevel: 1.880, bpm: 4142 },
      "521": { hiLevel: 14.290, loLevel: 1.880, bpm: 4142 },
      "503": { hiLevel: 10.970, loLevel: 2.130, bpm: 2888 },
      "504": { hiLevel: 10.970, loLevel: 2.130, bpm: 2888 },
      "522": { hiLevel: 15.600, loLevel: 1.610, bpm: 11990 },
      "531": { hiLevel: 17.770, loLevel: 2.000, bmp: 12377 },
      "533": { hiLevel: 17.770, loLevel: 2.000, bpm: 12377 },
      "534": { hiLevel: 17.772, loLevel: 2.000, bpm: 12377 },

      // Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© - Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© B3 PCNA
      "467": { hiLevel: 17.771, loLevel: 2.000, bpm: 12375 },
      "468": { hiLevel: 17.771, loLevel: 2.000, bpm: 12375 },
      "469": { hiLevel: 17.771, loLevel: 2.000, bpm: 12375 },
      "470": { hiLevel: 17.770, loLevel: 2.000, bpm: 12375 },
      "301": { hiLevel: 18.540, loLevel: 3.048, bpm: 7756 },
      "302": { hiLevel: 18.540, loLevel: 3.048, bpm: 7756 },

      // Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø© - Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© 4
      "305": { hiLevel: 18.797, loLevel: 0.533, bpm: 7171 },
      "620": { hiLevel: 16.500, loLevel: 1.650, bpm: 11981 },
      "621": { hiLevel: 16.500, loLevel: 1.650, bpm: 11981 },
      "622": { hiLevel: 15.760, loLevel: 2.000, bpm: 5019 },
      "623": { hiLevel: 15.760, loLevel: 1.600, bpm: 5050 },
      "661": { hiLevel: 17.759, loLevel: 2.000, bpm: 12354 },
      "662": { hiLevel: 14.802, loLevel: 2.000, bpm: 5074 },
      "663": { hiLevel: 10.230, loLevel: 2.000, bpm: 1507 },
      "664": { hiLevel: 15.220, loLevel: 2.000, bpm: 7250 },
      "665": { hiLevel: 15.220, loLevel: 2.000, bpm: 7250 },
      "673": { hiLevel: 18.000, loLevel: 2.000, bpm: 7250 },
      "454": { hiLevel: 11.360, loLevel: 2.000, bpm: 1653 },
      "455": { hiLevel: 11.360, loLevel: 2.000, bpm: 1654 },

      // Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø®Ø§Ù…Ø³Ø© - Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© 5
      "820": { hiLevel: 18.480, loLevel: 1.600, bpm: 16656 },
      "821": { hiLevel: 18.480, loLevel: 1.600, bpm: 16656 },
      "755": { hiLevel: 15.100, loLevel: 2.000, bpm: 12834 },
      "756": { hiLevel: 15.100, loLevel: 2.000, bpm: 12962 },
      "757": { hiLevel: 17.800, loLevel: 2.000, bpm: 10989 },
      "831": { hiLevel: 18.410, loLevel: 2.000, bpm: 11297 },
      "832": { hiLevel: 18.409, loLevel: 2.000, bpm: 11297 },
      "833": { hiLevel: 18.012, loLevel: 3.250, bpm: 7279 },
      "834": { hiLevel: 18.012, loLevel: 3.250, bpm: 7279 },
      "835": { hiLevel: 15.226, loLevel: 2.000, bpm: 7305 },
      "836": { hiLevel: 15.226, loLevel: 2.000, bpm: 7305 },
      "900": { hiLevel: 11.900, loLevel: 1.600, bpm: 2644 },
      "901": { hiLevel: 12.020, loLevel: 2.000, bpm: 2692 },

      // Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø³Ø§Ø¯Ø³Ø© - Ù…Ø­Ø·Ø© Ø§Ù„ØªØ¹Ø¨Ø¦Ø©
      "725": { hiLevel: 11.887, loLevel: 0.914, bpm: 1080 },
      "510": { hiLevel: 10.363, loLevel: 2.000, bpm: 529 },
      "507": { hiLevel: 6.500, loLevel: 2.000, bpm: 413 },
      "511": { hiLevel: 9.000, loLevel: 0.198, bpm: 4531 },

      // Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ø¹Ø© - Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø®Ø²Ø§Ù†Ø§Øª
      "508": { hiLevel: 12.650, loLevel: 1.670, bpm: 1130 },
      "509": { hiLevel: 12.650, loLevel: 1.670, bpm: 1130 },
      "512": { hiLevel: 11.600, loLevel: 0.920, bpm: 2939 },
      "514": { hiLevel: 12.000, loLevel: 0.920, bpm: 2942 },
      "515": { hiLevel: 12.000, loLevel: 0.920, bpm: 2942 },
      "532": { hiLevel: 17.772, loLevel: 2.000, bpm: 12377 },
      "671": { hiLevel: 16.450, loLevel: 2.000, bpm: 12863 },
      "672": { hiLevel: 16.450, loLevel: 2.000, bpm: 13046 },

      // Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø«Ø§Ù…Ù†Ø© - Ø³Ù„Ø³Ù„Ø© 200
      "225": { hiLevel: 15.240, loLevel: 3.353, bpm: 12879 },
      "226": { hiLevel: 15.240, loLevel: 3.353, bpm: 12879 },
      "227": { hiLevel: 17.950, loLevel: 2.000, bpm: 11327 },
      "255": { hiLevel: 14.960, loLevel: 2.000, bpm: 12287 },
      "256": { hiLevel: 14.960, loLevel: 2.000, bpm: 12287 },
      "260": { hiLevel: 13.000, loLevel: 2.000, bpm: 2249 },
      "451": { hiLevel: 13.000, loLevel: 2.000, bpm: 930 },
      "506": { hiLevel: 14.330, loLevel: 0.920, bpm: 930 },
      "608": { hiLevel: 11.887, loLevel: 2.000, bpm: 1060 },
      "450": { hiLevel: 14.200, loLevel: 2.000, bpm: 3155 },
      "452": { hiLevel: 13.000, loLevel: 2.000, bpm: 4587 },
      "453": { hiLevel: 17.800, loLevel: 2.000, bpm: 5067 },
      "456": { hiLevel: 13.410, loLevel: 2.680, bpm: 11574 },
      "457": { hiLevel: 16.450, loLevel: 5.400, bpm: 9697 },
      "458": { hiLevel: 16.450, loLevel: 5.400, bpm: 9697 },
      "459": { hiLevel: 14.350, loLevel: 2.000, bpm: 9466 },
      "460": { hiLevel: 17.650, loLevel: 2.000, bpm: 14213 },

      // Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªØ§Ø³Ø¹Ø© - Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø©
      "461": { hiLevel: 17.653, loLevel: 2.000, bpm: 14213 },
      "462": { hiLevel: 16.460, loLevel: 2.000, bpm: 12354 },
      "463": { hiLevel: 17.890, loLevel: 2.000, bpm: 9578 },
      "464": { hiLevel: 17.889, loLevel: 2.000, bpm: 9578 },
      "465": { hiLevel: 17.890, loLevel: 2.000, bpm: 9572 },
    };

    function log(message, type = 'info') {
      const logDiv = document.getElementById('log');
      const entry = document.createElement('div');
      entry.className = `log ${type}`;
      entry.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
      logDiv.appendChild(entry);
      logDiv.scrollTop = logDiv.scrollHeight;
      console.log(message);
    }

    function updateProgress(percent, text) {
      document.getElementById('progressBar').style.width = percent + '%';
      document.getElementById('progressText').textContent = text;
    }

    function showDataStatistics() {
      const totalTanks = Object.keys(completeKNPCData).length;
      const series22 = Object.keys(completeKNPCData).filter(id => id.startsWith('2') || id.startsWith('4') || id.startsWith('5')).length;
      const series61 = Object.keys(completeKNPCData).filter(id => id.startsWith('6') || id.startsWith('7') || id.startsWith('8') || id.startsWith('9') || id.startsWith('3')).length;
      
      document.getElementById('dataStats').innerHTML = `
        <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®Ø²Ø§Ù†Ø§Øª:</strong> ${totalTanks} Ø®Ø²Ø§Ù†</p>
        <p><strong>Ø³Ù„Ø³Ù„Ø© TK-22-xxx:</strong> ${series22} Ø®Ø²Ø§Ù†</p>
        <p><strong>Ø³Ù„Ø³Ù„Ø© TK-61-xxx:</strong> ${series61} Ø®Ø²Ø§Ù†</p>
        <p><strong>Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> 11 ØµÙˆØ±Ø© Ù…Ù† Ù†Ø¸Ø§Ù… KNPC Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</p>
      `;
    }

    function showDataSample() {
      const sampleIds = ['225', '510', '633', '756', '301'];
      const container = document.getElementById('dataSample');
      
      sampleIds.forEach(id => {
        if (completeKNPCData[id]) {
          const data = completeKNPCData[id];
          const row = document.createElement('div');
          row.className = 'tank-summary';
          row.innerHTML = `
            <span class="tank-id">TK-${id}</span>
            <span class="hi-level">${data.hiLevel}m</span>
            <span class="lo-level">${data.loLevel}m</span>
            <span class="bpm-value">${data.bpm} BPM</span>
            <span class="status">Ù†Ø¸Ø§Ù… KNPC</span>
          `;
          container.appendChild(row);
        }
      });
    }

    window.verifyCurrentData = async function() {
      log('ğŸ” ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ Firebase...', 'info');
      updateProgress(5, 'ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
      
      try {
        const tanksRef = collection(db, 'tankData', 'pbcr', 'tanks');
        const snapshot = await getDocs(tanksRef);
        
        log(`ğŸ“Š ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${snapshot.size} Ø®Ø²Ø§Ù† PBCR ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`, 'info');
        
        let needsUpdate = 0;
        let alreadyCorrect = 0;
        let noKNPCData = 0;
        
        for (const docSnapshot of snapshot.docs) {
          const tankId = docSnapshot.id;
          const currentData = docSnapshot.data();
          const knpcData = completeKNPCData[tankId];
          
          if (knpcData) {
            const currentComment = currentData.comment || 0;
            const currentMin = currentData.min || 0;
            const currentMax = currentData.max || 0;
            
            if (currentComment !== knpcData.bpm || 
                Math.abs(currentMin - knpcData.loLevel) > 0.01 || 
                Math.abs(currentMax - knpcData.hiLevel) > 0.01) {
              needsUpdate++;
            } else {
              alreadyCorrect++;
            }
          } else {
            noKNPCData++;
          }
        }
        
        updateProgress(100, 'Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙØ­Øµ');
        log('', 'info');
        log('ğŸ“Š === Ù…Ù„Ø®Øµ Ø§Ù„ÙØ­Øµ ===', 'success');
        log(`Ø®Ø²Ø§Ù†Ø§Øª ØªØ­ØªØ§Ø¬ ØªØ­Ø¯ÙŠØ«: ${needsUpdate}`, 'warning');
        log(`Ø®Ø²Ø§Ù†Ø§Øª ØµØ­ÙŠØ­Ø© Ø¨Ø§Ù„ÙØ¹Ù„: ${alreadyCorrect}`, 'success');
        log(`Ø®Ø²Ø§Ù†Ø§Øª Ø¨Ø¯ÙˆÙ† Ø¨ÙŠØ§Ù†Ø§Øª KNPC: ${noKNPCData}`, 'info');
        log(`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª KNPC Ø§Ù„Ù…ØªÙˆÙØ±Ø©: ${Object.keys(completeKNPCData).length}`, 'success');
        
      } catch (error) {
        log(`ğŸ’¥ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙØ­Øµ: ${error.message}`, 'error');
      }
    };

    window.updateAllTanks = async function() {
      log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø®Ø²Ø§Ù†Ø§Øª PBCR Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ù† Ù†Ø¸Ø§Ù… KNPC...', 'warning');
      updateProgress(5, 'ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø²Ø§Ù†Ø§Øª...');
      
      try {
        const tanksRef = collection(db, 'tankData', 'pbcr', 'tanks');
        const snapshot = await getDocs(tanksRef);
        
        log(`ğŸ“Š ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${snapshot.size} Ø®Ø²Ø§Ù† PBCR`, 'info');
        
        let processed = 0;
        let updated = 0;
        let skipped = 0;
        let errors = 0;
        
        const tanksWithKNPCData = Object.keys(completeKNPCData);
        log(`ğŸ¯ Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« ${tanksWithKNPCData.length} Ø®Ø²Ø§Ù† Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©`, 'warning');
        
        for (const docSnapshot of snapshot.docs) {
          const tankId = docSnapshot.id;
          const currentData = docSnapshot.data();
          const knpcData = completeKNPCData[tankId];
          
          processed++;
          updateProgress(10 + (processed / snapshot.size) * 80, `Ù…Ø¹Ø§Ù„Ø¬Ø© Ø®Ø²Ø§Ù† ${tankId}...`);
          
          try {
            if (knpcData) {
              // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù„ØªØ­Ø¯ÙŠØ«
              const needsUpdate = 
                (currentData.comment || 0) !== knpcData.bpm ||
                Math.abs((currentData.min || 0) - knpcData.loLevel) > 0.01 ||
                Math.abs((currentData.max || 0) - knpcData.hiLevel) > 0.01;
              
              if (needsUpdate) {
                await updateDoc(docSnapshot.ref, {
                  min: knpcData.loLevel,
                  max: knpcData.hiLevel,
                  comment: knpcData.bpm,
                  lastModified: serverTimestamp(),
                  updatedBy: 'knpc-complete-dataset-11-screenshots',
                  updatedAt: new Date().toISOString(),
                  source: 'knpc-system-real-data',
                  previousValues: {
                    min: currentData.min || 0,
                    max: currentData.max || 0,
                    comment: currentData.comment || 0
                  }
                });
                
                log(`âœ… Ø®Ø²Ø§Ù† ${tankId}: Ù…Ø­Ø¯Ø« - Ø¹Ø§Ù„ÙŠ: ${knpcData.hiLevel}mØŒ Ù…Ù†Ø®ÙØ¶: ${knpcData.loLevel}mØŒ BPM: ${knpcData.bpm}`, 'success');
                updated++;
              } else {
                log(`â„¹ï¸ Ø®Ø²Ø§Ù† ${tankId}: Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø© Ø¨Ø§Ù„ÙØ¹Ù„`, 'info');
              }
            } else {
              log(`âš ï¸ Ø®Ø²Ø§Ù† ${tankId}: Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª KNPC`, 'warning');
              skipped++;
            }
            
            await new Promise(resolve => setTimeout(resolve, 30));
            
          } catch (tankError) {
            log(`âŒ Ø®Ø²Ø§Ù† ${tankId}: ${tankError.message}`, 'error');
            errors++;
          }
        }
        
        updateProgress(100, 'Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒØ§Ù…Ù„!');
        
        log('', 'info');
        log('ğŸ‰ === Ø§Ù†ØªÙ‡Ù‰ ØªØ­Ø¯ÙŠØ« Ø®Ø²Ø§Ù†Ø§Øª PBCR ===', 'success');
        log(`ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬: ${processed} Ø®Ø²Ø§Ù†`, 'info');
        log(`âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­: ${updated} Ø®Ø²Ø§Ù†`, 'success');
        log(`â­ï¸ ØªÙ… ØªØ®Ø·ÙŠÙ‡: ${skipped} Ø®Ø²Ø§Ù†`, 'warning');
        log(`âŒ Ø£Ø®Ø·Ø§Ø¡: ${errors} Ø®Ø²Ø§Ù†`, 'error');
        log('', 'info');
        log('ğŸ’¡ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª KNPC Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© ØªÙ… ØªØ·Ø¨ÙŠÙ‚Ù‡Ø§!', 'success');
        log('ğŸ¯ Ø®Ø²Ø§Ù†Ø§Øª PBCR Ø¬Ø§Ù‡Ø²Ø© Ø§Ù„Ø¢Ù† Ù„Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©', 'success');
        
      } catch (error) {
        log(`ğŸ’¥ Ø®Ø·Ø£ Ø­Ø±Ø¬: ${error.message}`, 'error');
      }
    };

    window.showFullDataset = function() {
      log('ğŸ“‹ Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø© Ù…Ù† Ù†Ø¸Ø§Ù… KNPC...', 'info');
      
      const sortedIds = Object.keys(completeKNPCData).sort((a, b) => parseInt(a) - parseInt(b));
      
      log(`ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®Ø²Ø§Ù†Ø§Øª: ${sortedIds.length}`, 'info');
      log('', 'info');
      
      sortedIds.forEach(id => {
        const data = completeKNPCData[id];
        log(`TK-${id}: Ø¹Ø§Ù„ÙŠ=${data.hiLevel}mØŒ Ù…Ù†Ø®ÙØ¶=${data.loLevel}mØŒ BPM=${data.bpm}`, 'info');
      });
      
      log('', 'info');
      log('âœ… ØªÙ… Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
    };

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø±Ø¶
    showDataStatistics();
    showDataSample();
    
    log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø¸Ø§Ù… KNPC Ø¨Ù†Ø¬Ø§Ø­', 'success');
    log(`ğŸ“Š ${Object.keys(completeKNPCData).length} Ø®Ø²Ø§Ù† Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ­Ø¯ÙŠØ«`, 'info');
    log('ğŸ” Ø§Ø¶ØºØ· "ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©" Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø£ÙˆÙ„Ø§Ù‹', 'info');
    log('ğŸš€ Ø«Ù… Ø§Ø¶ØºØ· "ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø²Ø§Ù†Ø§Øª" Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©', 'warning');
    
  </script>
</body>
</html>